[
  {
    "ruleId": "",
    "ruleTitle": "Validate All Inputs with DTOs and ValidationPipe",
    "type": "bad",
    "code": "// main.ts\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n  await app.listen(3000);\n}\n\n// users.controller.ts\n@Post()\ncreate(@Body() createUserDto: any) {\n  // No validation - vulnerable to injection attacks!\n  return this.usersService.create(createUserDto);\n}",
    "language": "typescript",
    "description": "no validation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Validate All Inputs with DTOs and ValidationPipe",
    "type": "good",
    "code": "{\n  \"statusCode\": 400,\n  \"message\": [\n    \"email must be an email\",\n    \"password must be longer than or equal to 8 characters\"\n  ],\n  \"error\": \"Bad Request\"\n}",
    "language": "json",
    "description": "full validation"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Helmet Middleware for Security Headers",
    "type": "bad",
    "code": "// main.ts\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n\n  // Define routes before helmet - insecure!\n  app.route('/api', ...);\n\n  app.use(helmet());\n  await app.listen(3000);\n}",
    "language": "typescript",
    "description": "vulnerable headers"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Helmet Middleware for Security Headers",
    "type": "good",
    "code": "// main.ts\nimport helmet from 'helmet';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n\n  // Apply helmet FIRST, before routes and other middleware\n  app.use(helmet());\n\n  // Now define routes\n  app.route('/api', ...);\n\n  await app.listen(3000);\n}",
    "language": "typescript",
    "description": "Express"
  },
  {
    "ruleId": "",
    "ruleTitle": "Use Helmet Middleware for Security Headers",
    "type": "good",
    "code": "// main.ts\nimport helmet from '@fastify/helmet';\n\nasync function bootstrap() {\n  const app = await NestFactory.create(AppModule);\n\n  // Fastify uses register() instead of use()\n  await app.register(helmet);\n\n  await app.listen(3000);\n}",
    "language": "typescript",
    "description": "Fastify"
  }
]